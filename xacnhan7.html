<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Xác Nhận Mua Tài Khoản</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/xacnhan.css" />
</head>

<body>
    <div class="confirm-container">
        <div class="confirm-image">
            <img src="https://cdn-offer-photos.zeusx.com/12194b3d-4320-4786-ac93-e863e4350226.jpg"
                alt="Acc Blox Fruit">
        </div>
        <div class="confirm-info">
            <h2>Acc Blox Fruit #007</h2>
            <p>Level 2300 | Trái shadow<br><strong>Giá: 270.000 VNĐ</strong></p>

            <div class="extra-info">
                ✅ Tài khoản chính chủ, bảo hành 7 ngày<br>
                ✅ Đảm bảo không bị ban, có thể đổi mật khẩu<br>
                ✅ Liên hệ admin để nhận thông tin sau khi thanh toán
            </div>

            <button class="cancel-btn" onclick="cancelBuy()">quay lại</button>
            <button class="add-to-cart-btn" onclick="addToCart()">Thêm vào giỏ hàng</button>
            <button class="confirm-btn" onclick="confirmBuy()">Xác nhận mua</button>
        </div>
    </div>

    <!-- Guest Modal -->
    <div id="guest-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Continue as Guest or Sign In</h2>
            <p>You can view the account details as a guest, but purchasing requires an account.</p>
            <button id="continue-guest" style="background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-right: 10px;">Continue without Login</button>
            <button id="sign-in" style="background: #4caf50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Continue with Account</button>
        </div>
    </div>

    <script>
        // Check login
        if (!localStorage.getItem("isLoggedIn") && !sessionStorage.getItem("isLoggedIn")) {
            alert("Vui lòng đăng nhập để mua tài khoản!");
            window.location.href = "login.html";
        }

        function confirmBuy() {
            // Check login before allowing purchase
            if (!localStorage.getItem("isLoggedIn") && !sessionStorage.getItem("isLoggedIn")) {
                // Show modal for guests
                document.getElementById('guest-modal').style.display = 'block';
                return;
            }

            // Add to purchased accounts
            let purchasedAccounts = JSON.parse(localStorage.getItem('purchasedAccounts')) || [];
            purchasedAccounts.push('Acc Blox Fruit #007 - Level 2300 | Trái Shadow | 270.000 VNĐ');
            localStorage.setItem('purchasedAccounts', JSON.stringify(purchasedAccounts));

            // Show confirmation modal
            const isDarkMode = document.body.classList.contains('dark-mode');
            const modalBg = isDarkMode ? '#1e1e1e' : 'white';
            const textColor = isDarkMode ? 'white' : 'black';
            const confirmModal = document.createElement('div');
            confirmModal.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;">
                    <div style="background: ${modalBg}; color: ${textColor}; padding: 20px; border-radius: 10px; text-align: center;">
                        <h2>Cảm ơn bạn đã mua đúng tài khoản!</h2>
                        <p>Vui lòng liên hệ admin để nhận thông tin.</p>
                        <button onclick="this.parentElement.parentElement.remove()" style="background: #22c55e; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmModal);
        }

        function cancelBuy() {
            window.history.back();
        }

        // Guest Modal
        const guestModal = document.getElementById('guest-modal');
        const continueGuestBtn = document.getElementById('continue-guest');
        const signInBtn = document.getElementById('sign-in');

        continueGuestBtn.addEventListener('click', () => {
            guestModal.style.display = 'none';
            alert("Bạn không thể mua tài khoản khi chưa đăng nhập!");
        });

        signInBtn.addEventListener('click', () => {
            guestModal.style.display = 'none';
            window.location.href = 'signin.html';
        });

        // Close guest modal
        const guestCloseBtns = guestModal.querySelectorAll('.close');
        guestCloseBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                guestModal.style.display = 'none';
            });
        });

        window.addEventListener('click', (event) => {
            if (event.target === guestModal) {
                guestModal.style.display = 'none';
            }
        });

        // Dark Mode Toggle
        const body = document.body;

        // Load dark mode preference from localStorage
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
        }
    </script>
</body>

</html>


