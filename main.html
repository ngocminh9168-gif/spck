<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Shop B√°n Acc Blox Fruit Uy T√≠n</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/main.css" />
</head>

<body>
    <header>
        <h1>Shop B√°n Acc Blox Fruit Uy T√≠n</h1>
        <p>Acc Blox Fruit gi√° r·∫ª, uy t√≠n, h·ªó tr·ª£ 24/7</p>
    </header>
    <!-- CHATBOT -->
    <div class="chatbot" id="chatbotBox">
        <iframe src="https://www.chatbase.co/chatbot-iframe/s4FH-Fw4P9mC2P8-8kmh1" width="100%" height="100%"
            frameborder="0">
        </iframe>
    </div>
    
    <!-- TOGGLE BUTTON -->
    <button class="chat-toggle" onclick="toggleChat()">üí¨</button>
    <nav>
        <div class="nav-center">
            <a href="#">Trang ch·ªß</a>
            <a href="/more-acc.html">T√†i kho·∫£n</a>
            <a href="#huongdan">H∆∞·ªõng d·∫´n</a>
            <a href="#lienhe">Li√™n h·ªá</a>
            <img id="nav-profile-picture" src="" alt="Profile Picture" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; cursor: pointer; margin: 0 18px; display: none;">
            <span id="nav-icon" style="font-size: 24px; cursor: pointer; margin: 0 18px;">üë§</span>
        </div>
    </nav>

    <!-- User Modal -->
    <div id="user-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>User Account</h2>
            <div id="user-info">
                <div id="profile-picture-container">
                    <img id="profile-picture" src="" alt="Profile Picture" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; display: none;">
                </div>
            </div>
            <button id="settings-toggle" style="background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 20px;">Settings</button>
            <div id="settings-content" style="display: none;">
                <h4>Dark Mode</h4>
                <button id="dark-mode-toggle" style="background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">üåô Dark Mode</button>
            </div>
            <h3>Shopping Cart</h3>
            <div id="cart-items" style="display: flex; flex-wrap: wrap; gap: 10px;">
                <p>Your cart is empty.</p>
            </div>
            <button id="logout-btn">Logout</button>
        </div>
    </div>

    <!-- Guest Modal -->
    <div id="guest-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Continue as Guest or Sign In</h2>
            <p>You can view the account details as a guest, but purchasing requires an account.</p>
            <button id="continue-guest" style="background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-right: 10px;">Continue without Login</button>
            <button id="sign-in" style="background: #4caf50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Continue with Account</button>
        </div>
    </div>
    <a href="more-acc.html" style="text-decoration: none; color: inherit;">
        <div class="banner">
            <img src="https://copilot.microsoft.com/th/id/BCO.6f19de7d-0382-46c4-8618-c64df287eec0.png" alt="Blox Fruits Banner">
            <div class="text-overlay">
            </div>
        </div>
    </a>
    <div class="container">
        <h2 id="sanpham">C√°c t√†i kho·∫£n n·ªïi b·∫≠t</h2>
        <div class="products">
            <!-- Product cards here (same as before) -->
        <div class="products" id="products-list">
            <div class="product-card">
                <img src="https://cdn-offer-photos.zeusx.com/79d8b91f-3849-41b4-812b-b14ed945313a.jpg"
                    alt="Acc Blox Fruit">
                <h3>Acc Blox Fruit #001</h3>
                <p>Level 2550 | Tr√°i Leopard | <b>400.000 VNƒê</b></p>
                <button class="add-to-cart-btn" data-name="Acc Blox Fruit #001" data-level="2550" data-fruit="Leopard" data-price="400.000 VNƒê" data-image="https://cdn-offer-photos.zeusx.com/79d8b91f-3849-41b4-812b-b14ed945313a.jpg">Add to Cart</button>
                <a href="xacnhan1.html" class="buy-link">Mua</a>
            </div>
            <div class="product-card">
                <img src="https://cdn-offer-photos.zeusx.com/78829ec3-ebf7-43e5-9aa7-14ed7faebbbb.jpg"
                    alt="Acc Blox Fruit">
                <h3>Acc Blox Fruit #002</h3>
                <p>Level 2550 | Tr√°i Dragon | <b>390.000 VNƒê</b></p>
                <button class="add-to-cart-btn" data-name="Acc Blox Fruit #002" data-level="2550" data-fruit="Dragon" data-price="390.000 VNƒê" data-image="https://cdn-offer-photos.zeusx.com/78829ec3-ebf7-43e5-9aa7-14ed7faebbbb.jpg">Add to Cart</button>
                <a href="xacnhan2.html" class="buy-link">Mua</a>
            </div>
            <div class="product-card">
                <img src="https://cdn-offer-photos.zeusx.com/947c1a4f-1c4b-4341-a767-1e283720827e.jpg" alt="Acc Blox Fruit">
                <h3>Acc Blox Fruit #003</h3>
                <p>Level 2500 | Tr√°i Dough | <b>350.000 VNƒê</b></p>
                <button class="add-to-cart-btn" data-name="Acc Blox Fruit #003" data-level="2500" data-fruit="Dough" data-price="350.000 VNƒê" data-image="https://cdn-offer-photos.zeusx.com/947c1a4f-1c4b-4341-a767-1e283720827e.jpg">Add to Cart</button>
                <a href="xacnhan3.html" class="buy-link">Mua</a>
            </div>
            <div class="product-card">
                <img src="https://cdn-offer-photos.zeusx.com/edf611a8-84f8-4a8f-8312-1adcad75dc13.jpg"
                    alt="Acc Blox Fruit">
                <h3>Acc Blox Fruit #004</h3>
                <p>Level 2450 | Tr√°i Venom | <b>320.000 VNƒê</b></p>
                <button class="add-to-cart-btn" data-name="Acc Blox Fruit #004" data-level="2450" data-fruit="Venom" data-price="320.000 VNƒê" data-image="https://cdn-offer-photos.zeusx.com/edf611a8-84f8-4a8f-8312-1adcad75dc13.jpg">Add to Cart</button>
                <a href="xacnhan4.html" class="buy-link">Mua</a>
            </div>
            <div class="product-card">
                <img src="https://cdn-offer-photos.zeusx.com/a62af644-d252-4fbc-a24e-18402b7ea141.jpg"
                    alt="Acc Blox Fruit">
                <h3>Acc Blox Fruit #005</h3>
                <p>Level 2400 | Tr√°i Buddha | <b>300.000 VNƒê</b></p>
                <a href="sacnhan5.html" class="buy-link">Mua</a>
            </div>
        </div>

        </div>
        <button class="show-more-btn" onclick="window.location.href='more-acc.html'">danh s√°ch t√†i kho·∫£n</button>
        <div class="info" style="text-align: center; background: #e3f2fd; border-color: #2196f3;">
            <h2>Submit Your Account for Sale</h2>
            <p>Have a Blox Fruit account to sell? Submit it for admin review and get it listed in our shop!</p>
            <a href="customer-accounts.html" class="show-more-btn submit-link" style="display: inline-block; margin-top: 10px;">Submit Account</a>
        </div>
        <div class="info">
            <h2>Th√¥ng tin Shop</h2>
            <ul>
                <li>Shop chuy√™n b√°n acc Blox Fruit uy t√≠n, b·∫£o h√†nh tr·ªçn ƒë·ªùi.</li>
                <li>Acc ƒëa d·∫°ng: full tr√°i √°c qu·ª∑, level cao, gi√° t·ªët.</li>
                <li>H·ªó tr·ª£ ƒë·ªïi pass, h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng acc.</li>
                <li>Li√™n h·ªá admin ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n v√† h·ªó tr·ª£ th√™m.</li>
            </ul>
        </div>
        <div class="guide" id="huongdan">
            <h2>H∆∞·ªõng d·∫´n mua acc Blox Fruit</h2>
            <ol>
                <li>Ch·ªçn t√†i kho·∫£n mu·ªën mua v√† b·∫•m "Mua ngay".</li>
                <li>Li√™n h·ªá admin qua Zalo/Facebook ƒë·ªÉ nh·∫≠n th√¥ng tin t√†i kho·∫£n.</li>
                <li>Chuy·ªÉn kho·∫£n theo h∆∞·ªõng d·∫´n, nh·∫≠n acc ngay l·∫≠p t·ª©c.</li>
                <li>Li√™n h·ªá admin n·∫øu c·∫ßn h·ªó tr·ª£ th√™m.</li>
            </ol>
        </div>
        <div class="contact" id="lienhe">
            <h2>Li√™n h·ªá h·ªó tr·ª£</h2>
            <p>Zalo: <b>0123 456 789</b></p>
            <p>Facebook: <a href="https://facebook.com/" target="_blank">Shop Acc Blox Fruit</a></p>
            <p>Email: <a href="mailto:shopbloxfruit@email.com">shopbloxfruit@email.com</a></p>
        </div>
<script>
                function toggleChat() {
                        const chat = document.getElementById("chatbotBox");
                        chat.style.display = chat.style.display === "none" ? "block" : "none";
                    }

                // User Modal
                const navProfileImg = document.getElementById('nav-profile-picture');
                const navIcon = document.getElementById('nav-icon');
                const userModal = document.getElementById('user-modal');
                const settingsToggle = document.getElementById('settings-toggle');
                const settingsContent = document.getElementById('settings-content');
                const darkModeToggle = document.getElementById('dark-mode-toggle');
                const body = document.body;
                const logoutBtn = document.getElementById('logout-btn');

                navProfileImg.addEventListener('click', () => {
                    userModal.style.display = 'block';
                    loadUserData();
                });

                navIcon.addEventListener('click', () => {
                    userModal.style.display = 'block';
                    loadUserData();
                });

                settingsToggle.addEventListener('click', () => {
                    settingsContent.style.display = settingsContent.style.display === 'none' ? 'block' : 'none';
                });

                // Load dark mode preference from localStorage
                if (localStorage.getItem('darkMode') === 'enabled') {
                    body.classList.add('dark-mode');
                    darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
                }

                darkModeToggle.addEventListener('click', () => {
                    body.classList.toggle('dark-mode');
                    if (body.classList.contains('dark-mode')) {
                        localStorage.setItem('darkMode', 'enabled');
                        darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
                    } else {
                        localStorage.setItem('darkMode', 'disabled');
                        darkModeToggle.textContent = 'üåô Dark Mode';
                    }
                });

                // Close modals
                const closeBtns = document.getElementsByClassName('close');
                for (let i = 0; i < closeBtns.length; i++) {
                    closeBtns[i].addEventListener('click', () => {
                        userModal.style.display = 'none';
                    });
                }

                window.addEventListener('click', (event) => {
                    if (event.target === userModal) {
                        userModal.style.display = 'none';
                    }
                });

                logoutBtn.addEventListener('click', () => {
                    localStorage.removeItem('user');
                    localStorage.removeItem('purchasedAccounts');
                    localStorage.removeItem('userName');
                    localStorage.removeItem('userEmail');
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('currentUser');
                    sessionStorage.removeItem('isLoggedIn');
                    sessionStorage.removeItem('currentUser');
                    window.location.href = 'login.html';
                });

                function loadUserData() {
                    const currentUser = localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser');
                    let username = 'Guest';
                    let email = 'guest@example.com';

                    if (currentUser) {
                        const users = JSON.parse(localStorage.getItem('users')) || [];
                        const user = users.find(u => u.name === currentUser);
                        if (user) {
                            username = user.name;
                            email = user.email;
                            // Set in localStorage for persistence
                            localStorage.setItem('userName', username);
                            localStorage.setItem('userEmail', email);
                        }
                    }

                    const profilePicture = localStorage.getItem('profilePicture');
                    const profileImg = document.getElementById('profile-picture');
                    const navProfileImg = document.getElementById('nav-profile-picture');
                    const navIcon = document.getElementById('nav-icon');
                    if (profilePicture) {
                        profileImg.src = profilePicture;
                        profileImg.style.display = 'block';
                        navProfileImg.src = profilePicture;
                        navProfileImg.style.display = 'inline';
                        navIcon.style.display = 'none';
                        navProfileImg.onerror = () => {
                            navProfileImg.style.display = 'none';
                            navIcon.style.display = 'inline';
                        };
                    } else {
                        profileImg.style.display = 'none';
                        navProfileImg.style.display = 'none';
                        navIcon.style.display = 'inline';
                    }
                    document.getElementById('user-info').innerHTML = `
                        <p><strong>Username:</strong> ${username}</p>
                        <p><strong>Email:</strong> ${email}</p>
                    `;

                    loadCart();
                }

                // Custom Accounts CRUD
                const accountForm = document.getElementById('account-form');
                const accountsList = document.getElementById('accounts-list');
                let editingIndex = -1;

                function loadAccounts() {
                    const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];
                    accountsList.innerHTML = '';
                    accounts.forEach((account, index) => {
                        const accountItem = document.createElement('div');
                        accountItem.className = 'account-item';
                        accountItem.innerHTML = `
                            <div class="account-info">
                                <img src="${account.image}" alt="${account.name}" style="width: 100px; height: 60px; object-fit: cover; border-radius: 4px; margin-right: 12px;">
                                <div>
                                    <strong>${account.name}</strong> - Level ${account.level} | ${account.fruit} | ${account.price}
                                </div>
                            </div>
                            <div class="account-actions">
                                <button class="edit-btn" onclick="editAccount(${index})">Edit</button>
                                <button class="delete-btn" onclick="deleteAccount(${index})">Delete</button>
                            </div>
                        `;
                        accountsList.appendChild(accountItem);
                    });
                }

                accountForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('account-name').value;
                    const level = document.getElementById('account-level').value;
                    const fruit = document.getElementById('account-fruit').value;
                    const price = document.getElementById('account-price').value;
                    const image = document.getElementById('account-image').value;

                    const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];

                    if (editingIndex >= 0) {
                        accounts[editingIndex] = { name, level, fruit, price, image };
                        editingIndex = -1;
                        accountForm.querySelector('button').textContent = 'Add Account';
                    } else {
                        accounts.push({ name, level, fruit, price, image });
                    }

                    localStorage.setItem('customAccounts', JSON.stringify(accounts));
                    accountForm.reset();
                    loadAccounts();
                });

                function editAccount(index) {
                    const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];
                    const account = accounts[index];
                    document.getElementById('account-name').value = account.name;
                    document.getElementById('account-level').value = account.level;
                    document.getElementById('account-fruit').value = account.fruit;
                    document.getElementById('account-price').value = account.price;
                    document.getElementById('account-image').value = account.image;
                    editingIndex = index;
                    accountForm.querySelector('button').textContent = 'Update Account';
                }

                function deleteAccount(index) {
                    const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];
                    accounts.splice(index, 1);
                    localStorage.setItem('customAccounts', JSON.stringify(accounts));
                    loadAccounts();
                }



                // Load accounts on page load
                loadAccounts();

                // Guest Modal
                const guestModal = document.getElementById('guest-modal');
                const continueGuestBtn = document.getElementById('continue-guest');
                const signInBtn = document.getElementById('sign-in');
                let targetUrl = '';

                // Check login for buy links
                document.querySelectorAll('.buy-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        const isLoggedInSession = sessionStorage.getItem("isLoggedIn") === "true";
                        const isLoggedInLocal = localStorage.getItem("isLoggedIn") === "true";
                        const isLoggedIn = isLoggedInSession || isLoggedInLocal;
                        if (!isLoggedIn) {
                            e.preventDefault();
                            targetUrl = this.href;
                            guestModal.style.display = 'block';
                        }
                    });
                });

                // Check login for submit link
                document.querySelectorAll('.submit-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        const isLoggedInSession = sessionStorage.getItem("isLoggedIn") === "true";
                        const isLoggedInLocal = localStorage.getItem("isLoggedIn") === "true";
                        const isLoggedIn = isLoggedInSession || isLoggedInLocal;
                        if (!isLoggedIn) {
                            e.preventDefault();
                            targetUrl = this.href;
                            guestModal.style.display = 'block';
                        }
                    });
                });

                continueGuestBtn.addEventListener('click', () => {
                    guestModal.style.display = 'none';
                    window.location.href = targetUrl;
                });

                signInBtn.addEventListener('click', () => {
                    guestModal.style.display = 'none';
                    window.location.href = 'signin.html';
                });

                // Close guest modal
                const guestCloseBtns = guestModal.querySelectorAll('.close');
                guestCloseBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        guestModal.style.display = 'none';
                    });
                });

                window.addEventListener('click', (event) => {
                    if (event.target === guestModal) {
                        guestModal.style.display = 'none';
                    }
                });

    // Load user data on page load to update nav
    loadUserData();

    // Add admin link if user is admin
    const currentUser = localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser');
    if (currentUser) {
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const user = users.find(u => u.name === currentUser);
        if (user && user.role === 'admin') {
            const navCenter = document.querySelector('.nav-center');
            const adminLink = document.createElement('a');
            adminLink.href = 'check-acc.html';
            adminLink.textContent = 'Admin';
            navCenter.appendChild(adminLink);
        }
    }

    // Load approved custom accounts
    function loadApprovedAccounts() {
        const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];
        const approvedAccounts = accounts.filter(acc => acc.status === 'approved');
        const productsList = document.getElementById('products-list');
        approvedAccounts.forEach(account => {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            productCard.innerHTML = `
                <img src="${account.image}" alt="${account.name}">
                <h3>${account.name}</h3>
                <p>Level ${account.level} | ${account.fruit} | <b>${account.price} VNƒê</b></p>
                <a href="xacnhan1.html" class="buy-link">Mua</a>
            `;
            productsList.appendChild(productCard);
        });
    }

    // Load approved accounts on page load
    loadApprovedAccounts();

                // Load approved custom accounts
                function loadApprovedAccounts() {
                    const accounts = JSON.parse(localStorage.getItem('customAccounts')) || [];
                    const approvedAccounts = accounts.filter(acc => acc.status === 'approved');
                    const productsList = document.getElementById('products-list');
                    approvedAccounts.forEach(account => {
                        const productCard = document.createElement('div');
                        productCard.className = 'product-card';
                        productCard.innerHTML = `
                            <img src="${account.image}" alt="${account.name}">
                            <h3>${account.name}</h3>
                            <p>Level ${account.level} | ${account.fruit} | <b>${account.price} VNƒê</b></p>
                            <a href="#" class="buy-link">Mua</a>
                        `;
                        productsList.appendChild(productCard);
                    });
                }

                // Load approved accounts on page load
                loadApprovedAccounts();

                // Shopping Cart Functionality
                function addToCart(name, level, fruit, price, image) {
                    const cart = JSON.parse(localStorage.getItem('cart')) || [];
                    const item = { name, level, fruit, price, image };
                    cart.push(item);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCart();
                    alert(`${name} added to cart!`);
                }

                function loadCart() {
                    const cart = JSON.parse(localStorage.getItem('cart')) || [];
                    const cartItemsDiv = document.getElementById('cart-items');
                    cartItemsDiv.innerHTML = '';
                    if (cart.length === 0) {
                        cartItemsDiv.innerHTML = '<p>Your cart is empty.</p>';
                        return;
                    }
                    cart.forEach((item, index) => {
                        const cartCard = document.createElement('div');
                        cartCard.className = 'cart-card';
                        cartCard.innerHTML = `
                            <img src="${item.image}" alt="${item.name}" style="width: 80px; height: 50px; object-fit: cover; border-radius: 4px;">
                            <div>
                                <h4>${item.name}</h4>
                                <p>Level ${item.level} | ${item.fruit} | ${item.price}</p>
                                <button onclick="removeFromCart(${index})" style="background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Remove</button>
                            </div>
                        `;
                        cartItemsDiv.appendChild(cartCard);
                    });
                }

                function removeFromCart(index) {
                    const cart = JSON.parse(localStorage.getItem('cart')) || [];
                    cart.splice(index, 1);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCart();
                }

                // Add event listeners to add-to-cart buttons
                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const name = btn.getAttribute('data-name');
                        const level = btn.getAttribute('data-level');
                        const fruit = btn.getAttribute('data-fruit');
                        const price = btn.getAttribute('data-price');
                        const image = btn.getAttribute('data-image');
                        addToCart(name, level, fruit, price, image);
                    });
                });

</script>
    </div>
    <div class="footer">
        &copy; 2025 Shop Acc Blox Fruit Uy T√≠n. All rights reserved.
    </div>
</body>